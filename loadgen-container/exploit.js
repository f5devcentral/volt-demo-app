import http from 'k6/http';
import { sleep, check } from 'k6';
import { addRandAgent } from './helpers.js';

export function exploit() {
    var badPaths = [
        "/?cmd=cat%20/etc/passwd",
        "/product?code=echo%20shell_exec(%27/sbin/ifconfig%20eth0%27);",
        "/product?id=4%20OR%201=1",
        "/../../../../etc/shadow",
        "/cart?search=aaa'><script>prompt('Please+enter+your+password');</script>",
        "/get-files?file=/etc/passwd",
        "/main.cgi?file=main.cgi",
        "/?query=<script>alert('XSS Beware')</script>",
        "/.htaccess",
        "/cart?page=https://shop.sa.f5demos.com/product/1YMWWN1N4O"
    ]
    var badPath = badPaths[Math.floor(Math.random()*badPaths.length)]
    
    const base = `${__ENV.TARGET_URL}`
    let res = http.get(base, addRandAgent()); //Get a session cookie
    res = http.get(base.concat(badPath), addRandAgent());
    check(res, {
        'status is 40X': (r) => r.status === 403
    });
    sleep(.2);
}

